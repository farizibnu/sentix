<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sentix - Hashtag Search</title>
    <!-- Include Bootstrap CSS from a CDN -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Allan:wght@700&family=Montserrat:wght@400;600;700&display=swap"
        rel="stylesheet">
    <style>
        /* Add transitions to the search form */
        #searchHashtag {
            transition: padding 0.3s ease-in-out, margin 0.3s ease-in-out;
        }

        #searchForm {
            transition: margin 0.3s ease-in-out;
        }

        #searchHashtagCard {
            transition: margin 0.3s ease-in-out;
        }
    </style>
</head>

<body>
    <nav class="navbar navbar-expand-lg static-top">
        <div class="container">
            <div>
                <img class="m-1" id="logo" src="{{ url_for('static', filename='img/logo.png') }}" alt="Logo" />
            </div>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false"
                aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            
            {% if session['membership'] == 'regular' %}
            <button type="button" data-bs-toggle="modal" data-bs-target="#membershipModal" class="card membership-card"
                style="background-color: grey; font-size: 1.2rem;">
                {% elif session['membership'] == 'premium' %}
                <button type="button" data-bs-toggle="modal" data-bs-target="#membershipModal"
                    class="card membership-card" style="background-color: gold; font-size: 1.2rem;">
                    {% else %}
                    <button type="button" data-bs-toggle="modal" data-bs-target="#membershipModal"
                        class="card membership-card" style="background-color: red; font-size: 1.2rem;">
                        {% endif %}
                        <div class="card-body">
                            <p class="card-text">{{ session['membership']|upper }}</p>
                        </div>
                    </button>

            <!-- Membership Modal -->
            <div class="modal fade" id="membershipModal" tabindex="-1" aria-labelledby="membershipModalLabel"
                aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="membershipModalLabel">Choose Membership Type</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal"
                                aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                            <p>Choose your desired membership type:</p>
                            <form action="{{ url_for('change_membership') }}" method="post">
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="membership"
                                        id="regularMembership" value="regular" checked>
                                    <label class="form-check-label" for="regularMembership">
                                        Regular Membership
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="membership"
                                        id="premiumMembership" value="premium">
                                    <label class="form-check-label" for="premiumMembership">
                                        Premium Membership
                                    </label>
                                </div>
                                <button type="submit" class="btn btn-primary mt-3">Change Membership</button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>

                    <div class="" id="">
                        <ul class="navbar-nav ms-auto">
                            <li class="nav-item">
                                <div class="dropdown">
                                    <a href="#" id="dropdownToggle" data-bs-toggle="dropdown"
                                        data-bs-target="#dropdownMenu" aria-expanded="false" class="dropdown-toggle"
                                        style="
                  color: white;
                  text-decoration: none;
                  border-bottom: 1px solid transparent;
                ">
                                        <img class="m-1 pe-1" id="user-logo"
                                            src="{{ url_for('static', filename='img/user.png') }}" alt="Logo" />
                                        {{ session['username'] }}
                                        <!-- Display the logged-in username -->
                                    </a>

                                    <ul class="dropdown-menu" id="dropdownMenu">
                                        <li>
                                            <a class="dropdown-item" href="{{ url_for('logout') }}"
                                                style="color: black">
                                                <img src="{{ url_for('static', filename='img/logout.png') }}"
                                                    alt="Logout Icon" class="logout-icon" />
                                                Logout
                                            </a>
                                        </li>
                                    </ul>
                                </div>
                            </li>
                        </ul>
                    </div>
        </div>
    </nav>

    <div class="container-fluid pt-4">
        <div class="row justify-content-center">
            <div class="col-12 col-sm-10 col-md-12 col-lg-11 col-xl-10">
                <div id="searchHashtagCard" class="card d-flex mx-auto">
                    <div class="row">
                        <div id="searchHashtag" class="col-lg-12 c2 px-5 pt-5">
                            <h3 class="text-bold">Search Hashtag</h3>
                            <form id="searchForm" action="/search" method="post" class="text-center mb-5">
                                <div class="input-group">
                                    <input type="text" name="hashtag" class="form-control search-form"
                                        placeholder="#Jungkook" />
                                </div>
                                <button class="btn btn-primary search-btn" type="submit">Search</button>
                            </form>
                        </div>
                    </div>
                </div>

                <div id="searchResults" class="card mt-5" style="display: none;">
                    <table class="table">
                        <thead>
                            <tr>
                                <th scope="col">ID</th>
                                <th scope="col">Username</th>
                                <th scope="col">Hashtags</th>
                                <th scope="col">Detail</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for post in search_results %}
                            <tr>
                                <td>{{ post.id }}</td>
                                <td>{{ post.user }}</td>
                                <td>{{ post.hashtags | join(', ') }}</td>
                                <td><button onclick="redirectToDetailPage('result')">Detail</button></td>
                                <td><button onclick="redirectToDetailPage('result')">Detail</button></td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <div id="searchResults" class="card mt-5" style="display: none">
            <table class="table">
                <thead>
                    <tr>
                        <th scope="col">Date</th>
                        <th scope="col">Video</th>
                        <th scope="col">Description</th>
                        <th scope="col">Sentimen</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Contoh Data -->
                    <tr>
                        <th scope="row">1</th>
                        <td>
                            <iframe src="https://www.tiktok.com/@soclean.yt/video/7283118591140957442" width="100%"
                                height="200" frameborder="0" allowfullscreen>
                            </iframe>
                        </td>
                        <td>Sample Description</td>
                        <td>Sample Sentimen</td>
                    </tr>
                    <tr>
                        <th scope="row">2</th>
                        <td>Sample Video</td>
                        <td>Sample Description</td>
                        <td>Sample Sentimen</td>
                    </tr>
                    <tr>
                        <th scope="row">3</th>
                        <td>Sample Video</td>
                        <td>Sample Description</td>
                        <td>Sample Sentimen</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
    {% with messages = get_flashed_messages() %} {% if messages %}
    <script src="https://cdn.jsdelivr.net/npm/popper.js@2.11.6/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.min.js"></script>
    <script>
        alert("{{ messages[-1] }}");
    </script>
    {% endif %} {% endwith %}
    <script>
        document
            .getElementById("searchForm")
            .addEventListener("submit", function (event) {
                event.preventDefault(); // Prevents the form from submitting (and reloading the page)
                document.getElementById("searchHashtagCard").style.margin = "0";
                document
                    .getElementById("searchHashtag")
                    .classList.remove("px-5", "pt-5");
                document
                    .getElementById("searchHashtag")
                    .classList.add("px-2", "pt-2");
                document.getElementById("searchForm").style.margin = "0";
                document.getElementById("searchForm").classList.remove("mb-5");
                document.getElementById("searchResults").style.display = "block";
                document.querySelector(".input-group").style.marginBottom = "0";
            });
    </script>
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            // Select the dropdown toggle element
            var dropdownToggle = document.querySelector("#dropdownToggle");

            // Add a click event listener to the dropdown toggle
            dropdownToggle.addEventListener("click", function () {
                // Toggle the dropdown menu display
                var dropdownMenu = document.querySelector("#dropdownMenu");
                dropdownMenu.classList.toggle("show");
            });

            // Close the dropdown when clicking outside of it
            document.addEventListener("click", function (event) {
                var dropdownMenu = document.querySelector("#dropdownMenu");
                if (
                    !event.target.matches("#dropdownToggle") &&
                    !dropdownMenu.contains(event.target)
                ) {
                    dropdownMenu.classList.remove("show");
                }
            });
        });

        function redirectToDetailPage(url) {
            window.location.href = url;
        }
    </script>
    <!-- Include Bootstrap JavaScript and Popper.js from CDNs if needed -->
    <!-- <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.min.js"></script> -->
    <!-- <script src="https://cdn.jsdelivr.net/npm/popper.js@2.11.6/dist/umd/popper.min.js"></script> -->
</body>

</html>